{% extends "ventas/base_dashboard.html" %}
{% block title %}Carrito de Venta{% endblock %}
{% block content %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Karla:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">

<div class="max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md karla">
  <h2 class="text-2xl font-bold text-blue-700 mb-6">Carrito de Productos</h2>

  {% if carrito_items %}
  <table class="w-full text-sm mb-6">
    <thead class="bg-blue-100 text-left">
      <tr>
        <th class="p-3">Producto</th>
        <th class="p-3 text-right">Precio</th>
        <th class="p-3 text-center">Cantidad</th>
        <th class="p-3 text-right">Subtotal</th>
        <th class="p-3 text-center">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for item in carrito_items %}
      <tr class="border-t">
        <td class="p-3">{{ item.producto.nombre }}</td>
        <td class="p-3">{{ item.producto.talla }}</td>
        <td class="p-3 text-right">S/ {{ item.producto.precio|floatformat:2 }}</td>
        <td class="p-3 text-center">{{ item.cantidad }}</td>
        <td class="p-3 text-right">S/ {{ item.subtotal|floatformat:2 }}</td>
        <td class="p-3 text-center">
          <form method="post" action="{% url 'eliminar_del_carrito' item.producto.id %}">
            {% csrf_token %}
            <button type="submit" class="text-red-600 hover:underline">Eliminar</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="text-right mb-4">
    <p class="text-lg font-bold">Total: S/ {{ total|floatformat:2 }}</p>
  </div>

  <div class="flex justify-end">
    <a href="{% url 'registro_venta' %}" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition">
      Continuar con la Venta
    </a>
  </div>

  {% else %}
  <p class="text-center text-gray-500">El carrito está vacío.</p>
  {% endif %}
</div>
{% endblock %}
